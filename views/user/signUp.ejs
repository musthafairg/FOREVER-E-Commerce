<!DOCTYPE html>
<html lang="en">
<head>
    <meta charset="UTF-8">
    <meta name="viewport" content="width=device-width, initial-scale=1.0">
    <title>Sign Up | Forever</title>
    <link rel="stylesheet" href="/css/signup.css">
    <link href="https://fonts.googleapis.com/css2?family=Poppins:wght@300;400;500&display=swap" rel="stylesheet">
</head>
<body>

    <%- include('../partials/user/header.ejs') %>

    <section class="signup-container">
        <h2>Sign Up â€”</h2>

        <% if (typeof error !== 'undefined') { %>
            <div class="error-message"><%= error %></div>
        <% } %>

        <form action="/signUp" method="POST" class="signup-form" id="signup-form">

            <input type="text" id="name" name="name" placeholder="Name" required>
            <div id="error1" class="error-message1"></div>

            <input type="email" id="email" name="email" placeholder="Email" required>
            <div id="error2" class="error-message1"></div>

            <input type="text" id="mobile" name="mobile" placeholder="Mobile No" required>
            <div id="error3" class="error-message1"></div>

            <div class="password-wrapper">
            <input type="password" id="password" name="password" placeholder="Password" required>
            <i class="fa-regular fa-eye" id="togglePass"></i>
            </div>
            <div id="error4" class="error-message1"></div>

            <div class="password-wrapper">
            <input type="password" id="confirm-password" name="confirmPassword" placeholder="Confirm Password" required>
            <i class="fa-regular fa-eye" id="toggleConfirm"></i>
            </div>
            <div id="error5" class="error-message1"></div>


            <div class="options">
                <a href="/forgot-password" class="forgot">Forgot your password?</a>
                <a href="/login" class="login">Login Here</a>
            </div>

            <button type="submit" class="btn-signup">Sign Up</button>

            <div class="divider">
                <span>or</span>
            </div>

            <a href="/auth/google" class="btn-google">
                <img src="https://www.svgrepo.com/show/475656/google-color.svg" alt="Google logo">
                Login with Google
            </a>
        </form>
    </section>

    <%- include('../partials/user/footer.ejs') %>

    <!-- VALIDATION SCRIPT -->
    <script>
        const nameid = document.getElementById("name");
        const emailid = document.getElementById("email");
        const mobileid = document.getElementById("mobile");
        const passid = document.getElementById("password");
        const confirmid = document.getElementById("confirm-password");

        const error1 = document.getElementById("error1");
        const error2 = document.getElementById("error2");
        const error3 = document.getElementById("error3");
        const error4 = document.getElementById("error4");
        const error5 = document.getElementById("error5");

        const signupForm = document.getElementById("signup-form");

        function nameValidateChecking() {
            const nameval = nameid.value;
            const namepattern = /^[A-Za-z\s]+$/;

            if (nameval.trim() === "") {
                error1.style.display = "block";
                error1.innerHTML = "Please enter a valid name";
            } else if (!namepattern.test(nameval)) {
                error1.style.display = "block";
                error1.innerHTML = "Name can only contain alphabets and spaces";
            } else {
                error1.style.display = "none";
                error1.innerHTML = "";
            }
        }

        function emailValidateChecking() {
            const emailval = emailid.value;
            const emailPattern = /^([a-zA-Z0-9._-]+)@([a-zA-Z0-9.-]+)\.([a-zA-Z]{2,})$/;

            if (!emailPattern.test(emailval)) {
                error2.style.display = "block";
                error2.innerHTML = "Invalid Format";
            } else {
                error2.style.display = "none";
                error2.innerHTML = "";
            }
        }

        function mobileValidateChecking() {
            const mobileval = mobileid.value;

            if (mobileval.trim() === "") {
                error3.style.display = "block";
                error3.innerHTML = "Enter valid mobile number";
            } else if (mobileval.length !== 10) {
                error3.style.display = "block";
                error3.innerHTML = "Mobile number must be 10 digits";
            } else {
                error3.style.display = "none";
                error3.innerHTML = "";
            }
        }

        function passwordValidateChecking() {
            const passval = passid.value;
            const alpha = /[a-zA-Z]/;
            const digit = /\d/;

            if (passval.length < 8) {
                error4.style.display = "block";
                error4.innerHTML = "Should contain at least 8 characters";
            } else if (!alpha.test(passval) || !digit.test(passval)) {
                error4.style.display = "block";
                error4.innerHTML = "Should contain alphabets & digits";
            } else {
                error4.style.display = "none";
                error4.innerHTML = "";
            }
        }

        function confirmPasswordValidateChecking() {
            const passval = passid.value;
            const confirmval = confirmid.value;

            if (confirmval.trim() === "") {
                error5.style.display = "block";
                error5.innerHTML = "Please confirm your password";
            } else if (confirmval !== passval) {
                error5.style.display = "block";
                error5.innerHTML = "Passwords do not match";
            } else {
                error5.style.display = "none";
                error5.innerHTML = "";
            }
        }

        document.addEventListener("DOMContentLoaded", () => {
            signupForm.addEventListener("submit", (e) => {

                nameValidateChecking();
                emailValidateChecking();
                mobileValidateChecking();
                passwordValidateChecking();
                confirmPasswordValidateChecking();

                if (
                    error1.innerHTML ||
                    error2.innerHTML ||
                    error3.innerHTML ||
                    error4.innerHTML ||
                    error5.innerHTML
                ) {
                    e.preventDefault();
                }
            });
        });






 // ========= SHOW / HIDE PASSWORD ============= //
    const togglePass = document.getElementById("togglePass");
    const toggleConfirm = document.getElementById("toggleConfirm");

    togglePass.addEventListener("click", () => {
        passid.type = passid.type === "password" ? "text" : "password";
        togglePass.classList.toggle("fa-eye-slash");
    });

    toggleConfirm.addEventListener("click", () => {
        confirmid.type = confirmid.type === "password" ? "text" : "password";
        toggleConfirm.classList.toggle("fa-eye-slash");
    });

    </script>

    <script src="https://kit.fontawesome.com/a2e0e6cfd8.js" crossorigin="anonymous"></script>
</body>
</html>
